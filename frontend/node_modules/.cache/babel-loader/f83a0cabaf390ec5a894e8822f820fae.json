{"ast":null,"code":"var _jsxFileName = \"/Users/Roman/Desktop/RBP/frontend/src/components/ExportToExcel.js\";\n// ExportToExcel.js\nimport React from 'react';\nimport * as XLSX from 'xlsx';\nimport { utils, writeFile } from 'xlsx';\nconst ExportToExcel = ({\n  selectedEmployees,\n  vacationStartDates,\n  vacationEndDates\n}) => {\n  const handleExport = () => {\n    if (selectedEmployees.length === 0) {\n      alert(\"Нет выбранных сотрудников для экспорта.\");\n      return;\n    }\n\n    // Подготовка данных для экспорта\n    const exportData = selectedEmployees.map(emp => {\n      return {\n        \"Имя\": emp.first_name,\n        \"Фамилия\": emp.last_name,\n        \"Дата начала отпуска\": vacationStartDates[emp.id] ? vacationStartDates[emp.id].toLocaleDateString() : 'Не указано',\n        \"Дата окончания отпуска\": vacationEndDates[emp.id] ? vacationEndDates[emp.id].toLocaleDateString() : 'Не указано'\n      };\n    });\n    const worksheet = utils.json_to_sheet(exportData);\n    const workbook = utils.book_new();\n    utils.book_append_sheet(workbook, worksheet, 'Employees');\n    writeFile(workbook, 'employees.xlsx');\n  };\n  return /*#__PURE__*/React.createElement(\"button\", {\n    className: \"export-button\",\n    onClick: handleExport,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 9\n    }\n  }, \"\\u042D\\u043A\\u0441\\u043F\\u043E\\u0440\\u0442 \\u0432 Excel\");\n};\nexport default ExportToExcel;","map":{"version":3,"names":["React","XLSX","utils","writeFile","ExportToExcel","selectedEmployees","vacationStartDates","vacationEndDates","handleExport","length","alert","exportData","map","emp","first_name","last_name","id","toLocaleDateString","worksheet","json_to_sheet","workbook","book_new","book_append_sheet","createElement","className","onClick","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["/Users/Roman/Desktop/RBP/frontend/src/components/ExportToExcel.js"],"sourcesContent":["// ExportToExcel.js\nimport React from 'react';\nimport * as XLSX from 'xlsx';\nimport { utils, writeFile } from 'xlsx';\n\nconst ExportToExcel = ({ selectedEmployees, vacationStartDates, vacationEndDates }) => {\n    const handleExport = () => {\n        if (selectedEmployees.length === 0) {\n            alert(\"Нет выбранных сотрудников для экспорта.\");\n            return;\n        }\n\n        // Подготовка данных для экспорта\n        const exportData = selectedEmployees.map((emp) => {\n            return {\n                \"Имя\": emp.first_name,\n                \"Фамилия\": emp.last_name,\n                \"Дата начала отпуска\": vacationStartDates[emp.id]\n                    ? vacationStartDates[emp.id].toLocaleDateString()\n                    : 'Не указано',\n                \"Дата окончания отпуска\": vacationEndDates[emp.id]\n                    ? vacationEndDates[emp.id].toLocaleDateString()\n                    : 'Не указано'\n            };\n        });\n\n        const worksheet = utils.json_to_sheet(exportData);\n        const workbook = utils.book_new();\n        utils.book_append_sheet(workbook, worksheet, 'Employees');\n\n        writeFile(workbook, 'employees.xlsx');\n    };\n\n    return (\n        <button className=\"export-button\" onClick={handleExport}>\n            Экспорт в Excel\n        </button>\n    );\n};\n\nexport default ExportToExcel;\n"],"mappings":";AAAA;AACA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAO,KAAKC,IAAI,MAAM,MAAM;AAC5B,SAASC,KAAK,EAAEC,SAAS,QAAQ,MAAM;AAEvC,MAAMC,aAAa,GAAGA,CAAC;EAAEC,iBAAiB;EAAEC,kBAAkB;EAAEC;AAAiB,CAAC,KAAK;EACnF,MAAMC,YAAY,GAAGA,CAAA,KAAM;IACvB,IAAIH,iBAAiB,CAACI,MAAM,KAAK,CAAC,EAAE;MAChCC,KAAK,CAAC,yCAAyC,CAAC;MAChD;IACJ;;IAEA;IACA,MAAMC,UAAU,GAAGN,iBAAiB,CAACO,GAAG,CAAEC,GAAG,IAAK;MAC9C,OAAO;QACH,KAAK,EAAEA,GAAG,CAACC,UAAU;QACrB,SAAS,EAAED,GAAG,CAACE,SAAS;QACxB,qBAAqB,EAAET,kBAAkB,CAACO,GAAG,CAACG,EAAE,CAAC,GAC3CV,kBAAkB,CAACO,GAAG,CAACG,EAAE,CAAC,CAACC,kBAAkB,CAAC,CAAC,GAC/C,YAAY;QAClB,wBAAwB,EAAEV,gBAAgB,CAACM,GAAG,CAACG,EAAE,CAAC,GAC5CT,gBAAgB,CAACM,GAAG,CAACG,EAAE,CAAC,CAACC,kBAAkB,CAAC,CAAC,GAC7C;MACV,CAAC;IACL,CAAC,CAAC;IAEF,MAAMC,SAAS,GAAGhB,KAAK,CAACiB,aAAa,CAACR,UAAU,CAAC;IACjD,MAAMS,QAAQ,GAAGlB,KAAK,CAACmB,QAAQ,CAAC,CAAC;IACjCnB,KAAK,CAACoB,iBAAiB,CAACF,QAAQ,EAAEF,SAAS,EAAE,WAAW,CAAC;IAEzDf,SAAS,CAACiB,QAAQ,EAAE,gBAAgB,CAAC;EACzC,CAAC;EAED,oBACIpB,KAAA,CAAAuB,aAAA;IAAQC,SAAS,EAAC,eAAe;IAACC,OAAO,EAAEjB,YAAa;IAAAkB,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAC,yDAEjD,CAAC;AAEjB,CAAC;AAED,eAAe3B,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module"}